<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PSEmailRep PowerShell Module | Kyle Parrish</title>
<meta name=keywords content="powershell"><meta name=description content="Using the PSEmailRep PowerShell Module"><meta name=author content="Kyle Parrish"><link rel=canonical href=https://canonical.url/to/page><link crossorigin=anonymous href=http://localhost:1313/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/psemailrep-module/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="http://localhost:1313/posts/psemailrep-module/"><meta property="og:site_name" content="Kyle Parrish"><meta property="og:title" content="PSEmailRep PowerShell Module"><meta property="og:description" content="Using the PSEmailRep PowerShell Module"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-02-08T00:00:00+00:00"><meta property="article:modified_time" content="2020-02-08T00:00:00+00:00"><meta property="article:tag" content="Powershell"><meta property="og:image" content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:title content="PSEmailRep PowerShell Module"><meta name=twitter:description content="Using the PSEmailRep PowerShell Module"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"PSEmailRep PowerShell Module","item":"http://localhost:1313/posts/psemailrep-module/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PSEmailRep PowerShell Module","name":"PSEmailRep PowerShell Module","description":"Using the PSEmailRep PowerShell Module","keywords":["powershell"],"articleBody":"Introduction Hey! Kyle here. I recently released a small update to one of the PowerShell modules I put together to interact with EmailRep’s API and thought I would share a little about what it is and why I built it.\nGithub PowerShellGallery First of all, if you work in Information Security or IT in general, be sure to check out EmailRep.io. This is an excellent service built by a great group of people to provide enrichment data about an email address. Nearly all of our online interactions these days link back to an email address and it is important that we observe the “reputation” of email addresses that are used to interact with our systems.\nHere is a brief description of EmailRep by the EmailRep team:\nEmailRep uses hundreds of factors like domain age, traffic rankings, presence on social media sites, professional networking sites, personal connections, public records, deliverability, data breaches, dark web credential leaks, phishing emails, threat actor emails, and more to answer these types of questions:\nIs this email risky? Is this a throwaway account? What kind of online presence does this email have? Is this a trustworthy sender? PSEmailRep Goals After using EmailRep for a short time I quickly realized the value that it would add to my daily routines of triaging phishing emails and maintaing the many security aspects of our environment. With PowerShell being my daily-driver for automation and security tools I decided to put together a module that would interact with the EmailRep API. Seeing that nobody else at the time had been working on one I figured it would be a good project to start and share with the community. Some of the things that I was looking to accomplish were:\nMaintained in a Github repo Published to PowerShellGallery Helpful documentation on the available features Deployment pipeline Keep an eye out for a follow-up post on how I tackled these points. I learned a ton about building a module template with Plaster, running various checks with Pester, and preparing it to be pushed out to a central repository such as PowerShellGallery with PSDeploy.\nThe Module The goal of the PowerShell module isn’t to recreate the wheel, rather, simply take advantage of what is already available. The only thing I needed to do was to find a way to streamline it into my daily routines. The obvious choice for me was a PowerShell module…because…PowerShell! The available functions mimick what is currently available in the API Docs and as new endpoints are added more functions may be added to the module. Here are the current functions and what they are used for.\nPS\u003e Get-EmailRep ❯ Get-EmailRep bill@microsoft.com email : bill@microsoft.com reputation : high suspicious : False references : 85 blacklisted : False malicious_activity : False malicious_activity_recent : False credentials_leaked : True credentials_leaked_recent : False data_breach : True first_seen : 07/01/2008 last_seen : 10/16/2019 domain_exists : True domain_reputation : high new_domain : False days_since_domain_creation : 10512 suspicious_tld : False spam : False free_provider : False disposable : False deliverable : True accept_all : True valid_mx : True spoofable : False spf_strict : True dmarc_enforced : True profiles : {twitter, vimeo, pinterest, angellist...} This function does a GET query against the EmailRep API to collect what is already known, if anything, about the email address. In this case, bill@microsoft.com has several different peices of enrichment data that could help determine the reputation of the address. Now, most of this information is simply information and it is up to you to determine what you do with that information. In this case, EmailRep believes the reputation of this address to be “high”, but that does not mean that it is “good” or “trusted”. This simply means that there is enough information about address that it has a reputation.\nHow can I use this information?\nWell, lets take a look at the following:\nblacklisted : False malicious_activity : False malicious_activity_recent : False credentials_leaked : True credentials_leaked_recent : False data_breach : True This information indicates that while there are no reports of malicious activity on the account there are reports that it has been listed in recent breach reports or credential leaks. This is important to consider when allowing this account to interact with users in your environment or with your services. It is possible that the account is in possession of a malicious actor and does not have the best of intentions. This may trigger you to look further into the account or require additional verification before proceeding.\nThese indicators are what I find very useful when triaging phishing emails:\ndomain_exists : True domain_reputation : high new_domain : False days_since_domain_creation : 10512 A quick look at the domain details helps identify if this is a newly created domain and what the current reputation on that domain is. Often times, we will see that phishing emails are originating from domains that are only hours, or sometimes minutes, old. This typically an indicator of malicious activity.\nYou can take a look at the meaning of each attribute by heading over to the API Docs.\nPS\u003e New-EmailRep This function is used to report email addresses to the EmailRep API. It does require an API key and you can request one over at EmailRep’s site.\nAn example report would look like:\nNew-EmailRep -Email bill@microsoft.com ` -Tags bec,credential_phishing ` -Description 'Compromised account sending Sharepoint login page clone' ` -APIKey '4a534f4e20697320626574746572207468616e20584d4c21' This will report to EmailRep that bill@microsoft.com has been involved in a Business Email Compromise and is sending credential phishing via fake Sharepoint login pages.\nWhile the EmailRep API does not yet allow you to review these reports once they are submitted it is certainly on the road map. Having access to this data will greatly improve the accuracy of the determined ‘reputation’ of the email address.\nPS\u003e Set-EmailRep This function is used to save your API key to your user profile so you do not need to include it on every execution. Currently, this utilized PowerShell’s secure string capabilities to encrypt the key in an XML file for later retrieval (each time Get-EmailRep or New-EmailRep is called). This key can only be read by the user that set it thanks to Windows DPAPI. DPAPI is also a great topic to discuss. I learned a lot about how it is used and the risk it introduces…but that is for another day.\nTo use set-emailrep simply run the command and enter in your APIKey. If you have previously ran this command it will alert you and ask if you would like to overwrite the existing entry.\nFinal Thoughts This has been a learning process and opened up many new rabbit holes to follow. I plan on continueing to share these as I tackle them. Hopefully somebody out there will find it useful. I know I wouldn’t be where I am at without the contributions that others have made to the community. It is by their encouragement that I want to share my experiences as well and return the favor. Let me know what you think and if you have any questions about PSEmailRep!\n","wordCount":"1177","inLanguage":"en","image":"http://localhost:1313/%3Cimage%20path/url%3E","datePublished":"2020-02-08T00:00:00Z","dateModified":"2020-02-08T00:00:00Z","author":{"@type":"Person","name":"Kyle Parrish"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/psemailrep-module/"},"publisher":{"@type":"Organization","name":"Kyle Parrish","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Kyle Parrish (Alt + H)">Kyle Parrish</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/ title=Home><span>Home</span></a></li><li><a href=http://localhost:1313/posts/ title=Blog><span>Blog</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li><li><a href=http://localhost:1313/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">PSEmailRep PowerShell Module</h1><div class=post-description>Using the PSEmailRep PowerShell Module</div><div class=post-meta><span title='2020-02-08 00:00:00 +0000 UTC'>February 8, 2020</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1177 words&nbsp;·&nbsp;Kyle Parrish&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/psemailrep-module.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#goals>Goals</a></li><li><a href=#the-module>The Module</a><ul><li><a href=#ps-get-emailrep>PS> Get-EmailRep</a></li><li><a href=#ps-new-emailrep>PS> New-EmailRep</a></li><li><a href=#ps-set-emailrep>PS> Set-EmailRep</a></li></ul></li><li><a href=#final-thoughts>Final Thoughts</a></li></ul></nav></div></details></div><div class=post-content><h1 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h1><p>Hey! Kyle here. I recently released a small update to one of the PowerShell modules I put together to interact with EmailRep&rsquo;s API and thought I would share a little about what it is and why I built it.</p><ul><li><a href=https://github.com/arnydo/psemailrep>Github</a></li><li><a href=https://www.powershellgallery.com/packages/psemailrep>PowerShellGallery</a></li></ul><p><img alt=PSEmailRep loading=lazy src=https://github.com/arnydo/PSEmailRep/raw/master/Media/screenshot.png></p><p>First of all, if you work in Information Security or IT in general, be sure to check out <a href=https://emailrep.io>EmailRep.io</a>. This is an excellent service built by a great group of people to provide enrichment data about an email address. Nearly all of our online interactions these days link back to an email address and it is important that we observe the &ldquo;reputation&rdquo; of email addresses that are used to interact with our systems.</p><p>Here is a brief description of EmailRep by the EmailRep team:</p><p><em>EmailRep uses hundreds of factors like domain age, traffic rankings, presence on social media sites, professional networking sites, personal connections, public records, deliverability, data breaches, dark web credential leaks, phishing emails, threat actor emails, and more to answer these types of questions:</em></p><ul><li><em>Is this email risky?</em></li><li><em>Is this a throwaway account?</em></li><li><em>What kind of online presence does this email have?</em></li><li><em>Is this a trustworthy sender?</em></li></ul><h1 id=psemailrep>PSEmailRep<a hidden class=anchor aria-hidden=true href=#psemailrep>#</a></h1><h2 id=goals>Goals<a hidden class=anchor aria-hidden=true href=#goals>#</a></h2><p>After using EmailRep for a short time I quickly realized the value that it would add to my daily routines of triaging phishing emails and maintaing the many security aspects of our environment. With PowerShell being my daily-driver for automation and security tools I decided to put together a module that would interact with the EmailRep API. Seeing that nobody else at the time had been working on one I figured it would be a good project to start and share with the community. Some of the things that I was looking to accomplish were:</p><ul><li>Maintained in a Github repo</li><li>Published to PowerShellGallery</li><li>Helpful documentation on the available features</li><li>Deployment pipeline</li></ul><p>Keep an eye out for a follow-up post on how I tackled these points. I learned a ton about building a module template with <a href=https://github.com/PowerShell/Plaster>Plaster</a>, running various checks with <a href=https://github.com/pester/Pester>Pester</a>, and preparing it to be pushed out to a central repository such as PowerShellGallery with <a href=https://github.com/RamblingCookieMonster/PSDeploy>PSDeploy</a>.</p><h2 id=the-module>The Module<a hidden class=anchor aria-hidden=true href=#the-module>#</a></h2><p>The goal of the PowerShell module isn&rsquo;t to recreate the wheel, rather, simply take advantage of what is already available. The only thing I needed to do was to find a way to streamline it into my daily routines. The obvious choice for me was a PowerShell module&mldr;because&mldr;PowerShell! The available functions mimick what is currently available in the <a href=https://docs.emailrep.io/>API Docs</a> and as new endpoints are added more functions may be added to the module. Here are the current functions and what they are used for.</p><h3 id=ps-get-emailrep>PS> Get-EmailRep<a hidden class=anchor aria-hidden=true href=#ps-get-emailrep>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=err>❯</span> <span class=nb>Get-EmailRep</span> <span class=n>bill</span><span class=nv>@microsoft</span><span class=p>.</span><span class=py>com</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>email</span>                      <span class=err>:</span> <span class=n>bill</span><span class=nv>@microsoft</span><span class=p>.</span><span class=py>com</span>
</span></span><span class=line><span class=cl><span class=n>reputation</span>                 <span class=err>:</span> <span class=n>high</span>
</span></span><span class=line><span class=cl><span class=n>suspicious</span>                 <span class=err>:</span> <span class=n>False</span>
</span></span><span class=line><span class=cl><span class=n>references</span>                 <span class=err>:</span> <span class=mf>85</span>
</span></span><span class=line><span class=cl><span class=n>blacklisted</span>                <span class=err>:</span> <span class=n>False</span>
</span></span><span class=line><span class=cl><span class=n>malicious_activity</span>         <span class=err>:</span> <span class=n>False</span>
</span></span><span class=line><span class=cl><span class=n>malicious_activity_recent</span>  <span class=err>:</span> <span class=n>False</span>
</span></span><span class=line><span class=cl><span class=n>credentials_leaked</span>         <span class=err>:</span> <span class=n>True</span>
</span></span><span class=line><span class=cl><span class=n>credentials_leaked_recent</span>  <span class=err>:</span> <span class=n>False</span>
</span></span><span class=line><span class=cl><span class=n>data_breach</span>                <span class=err>:</span> <span class=n>True</span>
</span></span><span class=line><span class=cl><span class=n>first_seen</span>                 <span class=err>:</span> <span class=mf>07</span><span class=p>/</span><span class=mf>01</span><span class=p>/</span><span class=mf>2008</span>
</span></span><span class=line><span class=cl><span class=n>last_seen</span>                  <span class=err>:</span> <span class=mf>10</span><span class=p>/</span><span class=mf>16</span><span class=p>/</span><span class=mf>2019</span>
</span></span><span class=line><span class=cl><span class=n>domain_exists</span>              <span class=err>:</span> <span class=n>True</span>
</span></span><span class=line><span class=cl><span class=n>domain_reputation</span>          <span class=err>:</span> <span class=n>high</span>
</span></span><span class=line><span class=cl><span class=n>new_domain</span>                 <span class=err>:</span> <span class=n>False</span>
</span></span><span class=line><span class=cl><span class=n>days_since_domain_creation</span> <span class=err>:</span> <span class=mf>10512</span>
</span></span><span class=line><span class=cl><span class=n>suspicious_tld</span>             <span class=err>:</span> <span class=n>False</span>
</span></span><span class=line><span class=cl><span class=n>spam</span>                       <span class=err>:</span> <span class=n>False</span>
</span></span><span class=line><span class=cl><span class=n>free_provider</span>              <span class=err>:</span> <span class=n>False</span>
</span></span><span class=line><span class=cl><span class=n>disposable</span>                 <span class=err>:</span> <span class=n>False</span>
</span></span><span class=line><span class=cl><span class=n>deliverable</span>                <span class=err>:</span> <span class=n>True</span>
</span></span><span class=line><span class=cl><span class=n>accept_all</span>                 <span class=err>:</span> <span class=n>True</span>
</span></span><span class=line><span class=cl><span class=n>valid_mx</span>                   <span class=err>:</span> <span class=n>True</span>
</span></span><span class=line><span class=cl><span class=n>spoofable</span>                  <span class=err>:</span> <span class=n>False</span>
</span></span><span class=line><span class=cl><span class=n>spf_strict</span>                 <span class=err>:</span> <span class=n>True</span>
</span></span><span class=line><span class=cl><span class=n>dmarc_enforced</span>             <span class=err>:</span> <span class=n>True</span>
</span></span><span class=line><span class=cl><span class=n>profiles</span>                   <span class=err>:</span> <span class=p>{</span><span class=n>twitter</span><span class=p>,</span> <span class=n>vimeo</span><span class=p>,</span> <span class=n>pinterest</span><span class=p>,</span> <span class=n>angellist</span><span class=p>...}</span>
</span></span></code></pre></div><p>This function does a GET query against the EmailRep API to collect what is already known, if anything, about the email address. In this case, <a href=mailto:bill@microsoft.com>bill@microsoft.com</a> has several different peices of enrichment data that could help determine the reputation of the address. Now, most of this information is simply information and it is up to you to determine what you do with that information. In this case, EmailRep believes the reputation of this address to be &ldquo;high&rdquo;, but that does not mean that it is &ldquo;good&rdquo; or &ldquo;trusted&rdquo;. This simply means that there is enough information about address that it has a reputation.</p><blockquote><p>How can I use this information?</p></blockquote><p>Well, lets take a look at the following:</p><pre tabindex=0><code>blacklisted                : False
malicious_activity         : False
malicious_activity_recent  : False
credentials_leaked         : True
credentials_leaked_recent  : False
data_breach                : True
</code></pre><p>This information indicates that while there are no reports of malicious activity on the account there are reports that it has been listed in recent breach reports or credential leaks. This is important to consider when allowing this account to interact with users in your environment or with your services. It is possible that the account is in possession of a malicious actor and does not have the best of intentions. This may trigger you to look further into the account or require additional verification before proceeding.</p><p>These indicators are what I find very useful when triaging phishing emails:</p><pre tabindex=0><code>domain_exists              : True
domain_reputation          : high
new_domain                 : False
days_since_domain_creation : 10512
</code></pre><p>A quick look at the domain details helps identify if this is a newly created domain and what the current reputation on that domain is. Often times, we will see that phishing emails are originating from domains that are only hours, or sometimes minutes, old. This typically an indicator of malicious activity.</p><p>You can take a look at the meaning of each attribute by heading over to the <a href=https://docs.emailrep.io/technical-reference/reference/email/getemail>API Docs</a>.</p><h3 id=ps-new-emailrep>PS> New-EmailRep<a hidden class=anchor aria-hidden=true href=#ps-new-emailrep>#</a></h3><p>This function is used to report email addresses to the EmailRep API. It does require an API key and you can request one over at <a href=https://emailrep.io/key>EmailRep&rsquo;s site</a>.</p><p>An example report would look like:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>New-EmailRep</span> <span class=n>-Email</span> <span class=n>bill</span><span class=nv>@microsoft</span><span class=p>.</span><span class=py>com</span> <span class=p>`</span>
</span></span><span class=line><span class=cl>     <span class=n>-Tags</span> <span class=n>bec</span><span class=p>,</span><span class=n>credential_phishing</span> <span class=p>`</span>
</span></span><span class=line><span class=cl>     <span class=n>-Description</span> <span class=s1>&#39;Compromised account sending Sharepoint login page clone&#39;</span> <span class=p>`</span>
</span></span><span class=line><span class=cl>     <span class=n>-APIKey</span> <span class=s1>&#39;4a534f4e20697320626574746572207468616e20584d4c21&#39;</span>
</span></span></code></pre></div><p>This will report to EmailRep that <a href=mailto:bill@microsoft.com>bill@microsoft.com</a> has been involved in a <a href=https://www.trendmicro.com/vinfo/us/security/definition/business-email-compromise-(bec)>Business Email Compromise</a> and is sending credential phishing via fake Sharepoint login pages.</p><p>While the EmailRep API does not yet allow you to review these reports once they are submitted it is certainly on the road map. Having access to this data will greatly improve the accuracy of the determined &lsquo;reputation&rsquo; of the email address.</p><h3 id=ps-set-emailrep>PS> Set-EmailRep<a hidden class=anchor aria-hidden=true href=#ps-set-emailrep>#</a></h3><p>This function is used to save your API key to your user profile so you do not need to include it on every execution. Currently, this utilized PowerShell&rsquo;s <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.security/convertto-securestring?view=powershell-7">secure string</a> capabilities to encrypt the key in an XML file for later retrieval (each time Get-EmailRep or New-EmailRep is called). This key can only be read by the user that set it thanks to <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.security/convertfrom-securestring?view=powershell-7#description">Windows DPAPI</a>. DPAPI is also a great topic to discuss. I learned a lot about how it is used and the risk it introduces&mldr;but that is for another day.</p><p>To use <code>set-emailrep</code> simply run the command and enter in your APIKey. If you have previously ran this command it will alert you and ask if you would like to overwrite the existing entry.</p><h2 id=final-thoughts>Final Thoughts<a hidden class=anchor aria-hidden=true href=#final-thoughts>#</a></h2><p>This has been a learning process and opened up many new rabbit holes to follow. I plan on continueing to share these as I tackle them. Hopefully somebody out there will find it useful. I know I wouldn&rsquo;t be where I am at without the contributions that others have made to the community. It is by their encouragement that I want to share my experiences as well and return the favor. Let me know what you think and if you have any questions about PSEmailRep!</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/powershell/>Powershell</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/powershell-script-config-file/><span class=title>« Prev</span><br><span>Creating a Config File for your PowerShell Scripts</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share PSEmailRep PowerShell Module on x" href="https://x.com/intent/tweet/?text=PSEmailRep%20PowerShell%20Module&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fpsemailrep-module%2f&amp;hashtags=powershell"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share PSEmailRep PowerShell Module on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fpsemailrep-module%2f&amp;title=PSEmailRep%20PowerShell%20Module&amp;summary=PSEmailRep%20PowerShell%20Module&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fpsemailrep-module%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share PSEmailRep PowerShell Module on reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fpsemailrep-module%2f&title=PSEmailRep%20PowerShell%20Module"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share PSEmailRep PowerShell Module on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fpsemailrep-module%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share PSEmailRep PowerShell Module on whatsapp" href="https://api.whatsapp.com/send?text=PSEmailRep%20PowerShell%20Module%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fpsemailrep-module%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share PSEmailRep PowerShell Module on telegram" href="https://telegram.me/share/url?text=PSEmailRep%20PowerShell%20Module&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fpsemailrep-module%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share PSEmailRep PowerShell Module on ycombinator" href="https://news.ycombinator.com/submitlink?t=PSEmailRep%20PowerShell%20Module&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fpsemailrep-module%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>Kyle Parrish</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>